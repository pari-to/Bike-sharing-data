{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/paritoshkumar2022/bike-sharing-dataset?scriptVersionId=94058417\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"code","execution_count":1,"id":"eb25a893","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2022-04-26T13:05:55.167454Z","iopub.status.busy":"2022-04-26T13:05:55.165135Z","iopub.status.idle":"2022-04-26T13:05:56.455034Z","shell.execute_reply":"2022-04-26T13:05:56.453784Z"},"papermill":{"duration":1.297434,"end_time":"2022-04-26T13:05:56.456866","exception":false,"start_time":"2022-04-26T13:05:55.159432","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["── \u001b[1mAttaching packages\u001b[22m ─────────────────────────────────────── tidyverse 1.3.1 ──\n","\n","\u001b[32m✔\u001b[39m \u001b[34mggplot2\u001b[39m 3.3.5     \u001b[32m✔\u001b[39m \u001b[34mpurrr  \u001b[39m 0.3.4\n","\u001b[32m✔\u001b[39m \u001b[34mtibble \u001b[39m 3.1.6     \u001b[32m✔\u001b[39m \u001b[34mdplyr  \u001b[39m 1.0.8\n","\u001b[32m✔\u001b[39m \u001b[34mtidyr  \u001b[39m 1.2.0     \u001b[32m✔\u001b[39m \u001b[34mstringr\u001b[39m 1.4.0\n","\u001b[32m✔\u001b[39m \u001b[34mreadr  \u001b[39m 2.1.2     \u001b[32m✔\u001b[39m \u001b[34mforcats\u001b[39m 0.5.1\n","\n","── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n","\n"]},{"data":{"text/html":[],"text/latex":[],"text/markdown":[],"text/plain":["character(0)"]},"metadata":{},"output_type":"display_data"}],"source":["# This R environment comes with many helpful analytics packages installed\n","# It is defined by the kaggle/rstats Docker image: https://github.com/kaggle/docker-rstats\n","# For example, here's a helpful package to load\n","\n","library(tidyverse) # metapackage of all tidyverse packages\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","list.files(path = \"../input\")\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"markdown","id":"ef013db6","metadata":{"papermill":{"duration":0.001839,"end_time":"2022-04-26T13:05:56.460907","exception":false,"start_time":"2022-04-26T13:05:56.459068","status":"completed"},"tags":[]},"source":["install.packages(\"tidyverse\")\n","install.packages(\"lubridate\")\n","install.packages(\"janitor\")\n","library(tidyverse)\n","library(janitor)\n","library(lubridate)\n","library(scales)\n","\n","##Data Source :- www.divvybikes.com/data\n","\n","##creating data frames for trip data of 2004-2006 \n","r1 <- read.csv(\"my_2004.csv\")\n","r2 <- read.csv(\"my_2005.csv\")\n","r3 <- read.csv(\"202006-divvy-tripdata.csv\")\n","\n","### combining 3 dataframes into 1\n","bike_rides <- rbind(r1,r2,r3)\n","ncol(bike_rides)\n","nrow(bike_rides)\n","dim(bike_rides)\n","View(bike_rides)\n","### Removing any empty rows or columns\n","bike_rides <- janitor::remove_empty(bike_rides,which=c(\"cols\"))\n","bike_rides <- janitor::remove_empty(bike_rides,which=c(\"rows\"))\n","dim(bike_rides)\n","View(\"bike_rides\")\n","install.packages(\"geosphere\")\n","library(geosphere)\n","##As per requirement new column needs to be added in the sheet for#ride_duration,#month of the year #day of the week #Hour of day\n","pa_af<-bike_rides %>% \n","  mutate(ride_duration=as.numeric(difftime(ended_at,started_at,units = \"mins\"))) %>% \n","  mutate(ride_distance= distHaversine(cbind(start_lat,start_lng),cbind(end_lat,end_lng))) %>% \n","  mutate(ride_year=year(started_at)) %>% \n","  mutate(ride_month=month(started_at,label=TRUE)) %>% \n","  mutate(days_of_week=day(started_at)) %>% \n","  mutate(hour_of_day=hour(started_at))\n","###Filtering out empty data cell based on conditions\n","clean_data <- pa_af %>% \n","  filter(!is.na(start_station_name)) %>% \n","  filter(!is.na(end_station_name)) %>% \n","  filter(ride_distance>0) %>% \n","  filter(ride_duration>0)\n"," ### checking for data cleaned \n","View(clean_data)\n","\n","#Data Analysis Stage & Plotting the plot for visualization\n","ggplot(data = clean_data) +\n","  geom_bar(mapping = aes(x = hour_of_day,fill=hour_of_day))\n","ggplot(data = clean_data) +\n","  geom_bar(mapping = aes(x = ride_month,fill=ride_month))\n","ggplot(data = clean_data) +\n","  geom_bar(mapping = aes(x = member_casual,fill=member_casual))\n","clean_data %>% count(hour_of_day,sort = T) %>% \n","  ggplot()+geom_line(aes(x=hour_of_day,y=n))\n","![https://ca48560a3c6e48189899a82969e6a084.app.rstudio.cloud/file_show?path=%2Fcloud%2Fproject%2FRplot-Monthwise+distribution.jpeg]\n","![https://ca48560a3c6e48189899a82969e6a084.app.rstudio.cloud/file_show?path=%2Fcloud%2Fproject%2FRplot-No.+of+Hours+vs+count.jpeg]\n","![https://ca48560a3c6e48189899a82969e6a084.app.rstudio.cloud/file_show?path=%2Fcloud%2Fproject%2FRplot-Hours+of+day.jpeg]\n"]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":4.61379,"end_time":"2022-04-26T13:05:56.582099","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-04-26T13:05:51.968309","version":"2.3.4"}},"nbformat":4,"nbformat_minor":5}